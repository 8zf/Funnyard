<!-- BEGIN PAGE CONTENT INNER -->
<input type="hidden" id="aid" value="<%- activity.ActivityID %>">
<div class="page-content-inner">
    <div class="blog-page blog-content-2">
        <div class="row">
            <div class="col-lg-9">
                <div class="activity-content" id="activity_content">
                    <%- activity.Content %>
                </div>
                <button type="button" class="btn blue mt-ladda-btn ladda-button btn-outline" id="join_quit"
                        data-style="slide-up" data-spinner-color="#333">
                    <span class="ladda-label">
                        参加活动
                    </span>
                    <div class="ladda-progress" style="width: 0px;"></div>
                </button>
            </div>
            <div class="col-lg-3">
                <div class="blog-single-sidebar bordered blog-container">
                    <div class="blog-single-sidebar-search">
                        <div class="input-icon right">
                            <i class="icon-magnifier"></i>
                            <input type="text" class="form-control"
                                   placeholder="Search Blog"></div>
                    </div>
                    <div class="blog-single-sidebar-recent">
                        <h3 class="blog-sidebar-title uppercase">Recent Posts</h3>
                        <ul>
                            <li>
                                <a href="javascript:;">Metronic Admin Progress</a>
                            </li>
                            <li>
                                <a href="javascript:;">New UI Features</a>
                            </li>
                            <li>
                                <a href="javascript:;">Lorem Ipsum Dolore Amet</a>
                            </li>
                            <li>
                                <a href="javascript:;">Userfull Pages Released</a>
                            </li>
                        </ul>
                    </div>
                    <div class="blog-single-sidebar-tags">
                        <h3 class="blog-sidebar-title uppercase">Tags</h3>
                        <ul class="blog-post-tags">
                            <li class="uppercase">
                                <a href="javascript:;">Bootstrap</a>
                            </li>
                            <li class="uppercase">
                                <a href="javascript:;">Sass</a>
                            </li>
                            <li class="uppercase">
                                <a href="javascript:;">HTML</a>
                            </li>
                            <li class="uppercase">
                                <a href="javascript:;">CSS</a>
                            </li>
                            <li class="uppercase">
                                <a href="javascript:;">Gulp</a>
                            </li>
                            <li class="uppercase">
                                <a href="javascript:;">Framework</a>
                            </li>
                            <li class="uppercase">
                                <a href="javascript:;">Admin Theme</a>
                            </li>
                            <li class="uppercase">
                                <a href="javascript:;">UI Features</a>
                            </li>
                        </ul>
                    </div>
                    <div class="blog-single-sidebar-links">
                        <h3 class="blog-sidebar-title uppercase">Useful Links</h3>
                        <ul>
                            <li>
                                <a href="javascript:;">Lorem Ipsum </a>
                            </li>
                            <li>
                                <a href="javascript:;">Dolore Amet</a>
                            </li>
                            <li>
                                <a href="javascript:;">Metronic Database</a>
                            </li>
                            <li>
                                <a href="javascript:;">UI Features</a>
                            </li>
                            <li>
                                <a href="javascript:;">Advanced Forms</a>
                            </li>
                        </ul>
                    </div>
                    <div class="blog-single-sidebar-ui">
                        <h3 class="blog-sidebar-title uppercase">UI Examples</h3>
                        <div class="row ui-margin">
                            <div class="col-xs-4 ui-padding">
                                <a href="javascript:;">
                                    <img src="../assets/pages/img/background/1.jpg"/>
                                </a>
                            </div>
                            <div class="col-xs-4 ui-padding">
                                <a href="javascript:;">
                                    <img src="../assets/pages/img/background/37.jpg"/>
                                </a>
                            </div>
                            <div class="col-xs-4 ui-padding">
                                <a href="javascript:;">
                                    <img src="../assets/pages/img/background/57.jpg"/>
                                </a>
                            </div>
                            <div class="col-xs-4 ui-padding">
                                <a href="javascript:;">
                                    <img src="../assets/pages/img/background/53.jpg"/>
                                </a>
                            </div>
                            <div class="col-xs-4 ui-padding">
                                <a href="javascript:;">
                                    <img src="../assets/pages/img/background/59.jpg"/>
                                </a>
                            </div>
                            <div class="col-xs-4 ui-padding">
                                <a href="javascript:;">
                                    <img src="../assets/pages/img/background/42.jpg"/>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- END PAGE CONTENT INNER -->

<!-- BEGIN PAGE LEVEL PLUGINS -->
<script src="http://assets.funnyard.com/global/plugins/ladda/spin.min.js" type="text/javascript"></script>
<script src="http://assets.funnyard.com/global/plugins/ladda/ladda.min.js" type="text/javascript"></script>
<script>
  var action = "join";
  var aid = $("#aid").attr("value");
  var l = Ladda.create(document.getElementById("join_quit"));
  var options = {
    "closeButton": true,
    "debug": false,
    "positionClass": "toast-top-center",
    "onclick": null,
    "showDuration": "1000",
    "hideDuration": "1000",
    "timeOut": "5000",
    "extendedTimeOut": "1000",
    "showEasing": "swing",
    "hideEasing": "linear",
    "showMethod": "fadeIn",
    "hideMethod": "fadeOut"
  };
  $("#join_quit").click(function (e) {
    l.start();
    if (action == "join") {
      $.ajax({
        url: "/participate",
        data: {
          aid: aid
        },
        success: function (result,status,xhr) {
          console.log("result:");
          console.log(result);
          console.log("status: " + status);
          l.stop();
          toastr.success("参与成功", options);
          $("#join_quit").html("取消报名");
          action = "quit";
        },
        error: function (xhr,status,error) {
          l.stop();
          toastr.warning(xhr.responseText, options);
          if (xhr.responseText == "您已报名") {
            $("#join_quit").html("取消报名");
            action = "quit";
          }
          console.log("error")
          console.log(error);
          console.log(status);
          console.log(xhr.responseText);
        }
      });
    }
    else if (action == "quit") {
      $.ajax({
        url: "/quit",
        data: {
          aid: aid
        },
        success: function (result,status,xhr) {
          console.log("result:");
          console.log(result);
          console.log("status: " + status);
          l.stop();
          toastr.success("取消成功", options);
          $("#join_quit").html("参加活动");
          action = "quit";
        },
        error: function (xhr,status,error) {
          l.stop();
          toastr.warning(xhr.responseText, options);
          console.log("error")
          console.log(error);
          console.log(status);
          console.log(xhr.responseText);
        }
      });
    }
  });

</script>
<!-- END PAGE LEVEL PLUGINS -->

<!-- BEGIN PAGE LEVEL SCRIPTS -->
<script src="http://assets.funnyard.com/pages/scripts/ui-buttons.min.js" type="text/javascript"></script>
<!-- END PAGE LEVEL SCRIPTS -->